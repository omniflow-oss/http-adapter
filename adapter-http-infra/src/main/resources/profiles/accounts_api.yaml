ofkit:
  http:
    profiles:
      accounts_api:
        base_url: "https://api.accounts.example.com"
        rules:
          success:
            - id: ok-2xx-json-flag
              when:
                all:
                  - status: "200-299"
                  - json: { pointer: "/status", equals: "OK" }
              produce: { type: json, pick_pointer: "/data" }
          errors:
            - id: err-429
              when: { status: "429" }
              problem:
                type: "https://omniflow/rate-limit"
                title: "Rate limited"
                status: 429
        generic_problem:
          type: "about:blank"
          title: "Erreur service externe"
          status: 502
